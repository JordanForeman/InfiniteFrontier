window.app=window.app||{},app.Events={},app.Views={},app.Player=function(a){this.game=a,this.speed=200,this.fireRate=100,this.gameObject=this.game.add.sprite(this.game.world.centerX,this.game.world.centerY,"player"),this.gameObject.tint=8830938,this.gameObject.anchor.setTo(.5,.5),this.addListeners()},app.Player.prototype.addListeners=function(){app.Events.on("keypress",this.inputHandler.bind(this))},app.Player.prototype.stop=function(){var a=this.gameObject.body.velocity.x;if(!(0>=a)){var b=a-this.speed/10;this.gameObject.body.velocity.x=b}},app.Player.prototype.inputHandler=function(a){("up"==a||"space"==a&&this.gameObject.body.touching.down)&&(this.gameObject.body.velocity.y=-320),"left"==a?this.gameObject.body.velocity.x=-this.speed:"right"==a&&(this.gameObject.body.velocity.x=this.speed)},app.Constants={DIRECTION_FORWARD:"forward",DIRECTION_FORWARD_LEFT:"forward-left",DIRECTION_LEFT:"left",DIRECTION_AWAY_LEFT:"away-left",DIRECTION_AWAY:"away",DIRECTION_AWAY_RIGHT:"away-right",DIRECTION_RIGHT:"right",DIRECTION_FORWARD_RIGHT:"forward-right",TILE_WIDTH:32},app.Controller={cursors:null,game:null,init:function(a){this.game=a,this.cursors=this.game.input.keyboard.createCursorKeys(),this.game.input.keyboard.addKeyCapture([Phaser.Keyboard.LEFT,Phaser.Keyboard.RIGHT,Phaser.Keyboard.UP,Phaser.Keyboard.DOWN,Phaser.Keyboard.SPACEBAR]);var b=this.game.input.keyboard.addKey(Phaser.Keyboard.SPACEBAR);return b.onDown.add(function(){app.Events.trigger("keypress","space")}),this},checkInputs:function(){var a=null,b=!1;return this.cursors.up.isDown?(a="up",b=!0):this.cursors.down.isDown&&(a="down",b=!0),this.cursors.left.isDown?(a="left",b=!0):this.cursors.right.isDown&&(a="right",b=!0),b&&app.Events.trigger("keypress",a),b}},app.Events={events:{},on:function(a,b){var c=this.events[a]||[];c.push(b),this.events[a]=c},trigger:function(a,b){var c=this.events[a];!c||c.length<1||[].forEach.call(c,function(a){a(b)})}},app.Views.InitialView=function(a){this.game=a,this.controller=null,this.walls=null,this.bulletCache=null,this.water=[],this.physicsBodies=[],this.nextFire=0,this.gameBounds={height:2048,width:1024}},app.Views.InitialView.prototype={preload:function(){this.game.time.advancedTiming=!0,this.game.debug.renderShadow=!1,this.game.stage.disableVisibilityChange=!0,this.loadAssets(),this.game.physics.startSystem(Phaser.Physics.ARCADE)},create:function(){this.controller=app.Controller.init(this.game),this.createEnvironment(),this.createBulletCache(),this.createPlayer()},update:function(){var a=this.game,b=this.controller.checkInputs();b||this.player.stop(),a.input.activePointer.isDown&&this.fireBullets(),a.physics.arcade.collide(this.player.gameObject,this.walls),a.physics.arcade.collide(this.bulletCache,this.walls,this.bulletHitWall)},render:function(){var a=this.game;a.debug.text("Infinite Frontier - Alpha Build",2,a.world.length-100,"#000000"),a.debug.text(a.time.fps||"--",2,14,"#a7aebe"),a.debug.text(Phaser.VERSION,2,a.world.height-2,"#ffff00")},loadAssets:function(){this.game.load.image("player","/assets/player.png"),this.game.load.image("wallV","/assets/wallVertical.png"),this.game.load.image("wallH","/assets/wallHorizontal.png"),this.game.load.image("bullet","/assets/bullet.png")},createEnvironment:function(){var a=this.game;this.walls=a.add.group(),this.walls.enableBody=!0,a.add.sprite(0,0,"wallV",0,this.walls),a.add.sprite(480,0,"wallV",0,this.walls),a.add.sprite(0,0,"wallH",0,this.walls),a.add.sprite(300,0,"wallH",0,this.walls),a.add.sprite(0,320,"wallH",0,this.walls),a.add.sprite(300,320,"wallH",0,this.walls),a.add.sprite(-100,160,"wallH",0,this.walls),a.add.sprite(400,160,"wallH",0,this.walls);var b=a.add.sprite(100,80,"wallH",0,this.walls);b.scale.setTo(1.5,1);var c=a.add.sprite(100,240,"wallH",0,this.walls);c.scale.setTo(1.5,1),this.walls.setAll("body.immovable",!0),a.stage.backgroundColor="#3498db"},createBulletCache:function(){this.bulletCache=this.game.add.group(),this.bulletCache.enableBody=!0,this.bulletCache.physicsBodyType=Phaser.Physics.ARCADE,this.bulletCache.createMultiple(50,"bullet"),this.bulletCache.setAll("checkWorldBounds",!0),this.bulletCache.setAll("outOfBoundsKill",!0)},fireBullets:function(){if(this.game.time.now>this.nextFire&&this.bulletCache.countDead()>0){this.nextFire=this.game.time.now+this.player.fireRate;var a=this.bulletCache.getFirstDead();a.reset(this.player.gameObject.x,this.player.gameObject.y),a.rotation=this.game.physics.arcade.angleToPointer(a),this.game.physics.arcade.moveToPointer(a,300)}},createPlayer:function(){this.player=new app.Player(this.game),this.game.physics.arcade.enable(this.player.gameObject),this.player.gameObject.body.gravity.y=500,this.game.camera.follow(this.player.gameObject)},bulletHitWall:function(a){a.kill()},checkMouse:function(){}},app.Game={game:null,init:function(){this.game=new Phaser.Game(500,340,Phaser.AUTO,"test",null,!0,!1),this.addGameStates(),this.startGame()},addGameStates:function(){var a=new app.Views.InitialView(this.game);this.game.state.add("start",a)},startGame:function(){this.game.state.start("start")}},app.Game.init();